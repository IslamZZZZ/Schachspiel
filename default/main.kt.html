<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>main.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">main.kt</span></div><h1>main.kt</h1><pre class="source lang-java linenums">import Board.Board
import androidx.compose.desktop.ui.tooling.preview.Preview
import androidx.compose.foundation.background
import androidx.compose.foundation.layout.*
import androidx.compose.material.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.text.font.FontStyle
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.text.style.TextAlign
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import androidx.compose.ui.window.Window
import androidx.compose.ui.window.application
import androidx.compose.foundation.Image
import androidx.compose.foundation.border
import androidx.compose.foundation.clickable
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.items
import androidx.compose.foundation.lazy.rememberLazyListState
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.ui.draw.shadow
import androidx.compose.ui.layout.ContentScale
import androidx.compose.ui.res.painterResource
import androidx.compose.ui.window.Dialog
import androidx.compose.ui.window.DialogProperties
import figures.*


<span class="nc" id="L32">data class Language(val code: String, val name: String)</span>

enum class Screen {
<span class="nc" id="L35">    START,</span>
<span class="nc" id="L36">    GAME</span>
}


<span class="nc" id="L40">val availableLanguages = listOf(</span>
<span class="nc" id="L41">    Language(&quot;ru&quot;, &quot;Русский&quot;),</span>
<span class="nc" id="L42">    Language(&quot;en&quot;, &quot;English&quot;),</span>
<span class="nc" id="L43">    Language(&quot;de&quot;, &quot;Deutsch&quot;)</span>
)



// Список доступных языков
<span class="nc" id="L49">fun main() = application {</span>
<span class="nc bnc" id="L50" title="All 6 branches missed.">    var currentScreen by remember { mutableStateOf(Screen.START) }</span>
<span class="nc" id="L51">    val board = remember { Board() }</span>
<span class="nc" id="L52">    board.setup()</span>

<span class="nc bnc" id="L54" title="All 2 branches missed.">    Window(onCloseRequest = ::exitApplication, title = &quot;Das Schachspiel&quot;) {</span>
<span class="nc bnc" id="L55" title="All 8 branches missed.">        MaterialTheme {</span>
<span class="nc bnc" id="L56" title="All 9 branches missed.">                when(currentScreen) {</span>
<span class="nc" id="L57">                    Screen.START -&gt; StartScreen( { currentScreen = Screen.GAME } )</span>
<span class="nc" id="L58">                    Screen.GAME -&gt; GameScreen( { currentScreen = Screen.START }, board )</span>
<span class="nc bnc" id="L59" title="All 2 branches missed.">                }</span>
<span class="nc" id="L60">        }</span>
<span class="nc" id="L61">    }</span>
<span class="nc" id="L62">}</span>

@Composable
<span class="nc bnc" id="L65" title="All 18 branches missed.">fun standartButton(onButtonClick: () -&gt; Unit, text: String, colour: Color) {</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">    Button(</span>
<span class="nc" id="L67">        modifier = Modifier.height(80.dp),</span>
<span class="nc" id="L68">        onClick = onButtonClick,</span>
<span class="nc" id="L69">        colors = ButtonDefaults.buttonColors(backgroundColor = colour)</span>
<span class="nc" id="L70">    ) {</span>
<span class="nc bnc" id="L71" title="All 8 branches missed.">        Text(</span>
<span class="nc" id="L72">            text,</span>
<span class="nc" id="L73">            color = Color.White,</span>
<span class="nc" id="L74">            fontSize = 26.sp,</span>
<span class="nc" id="L75">            textAlign = TextAlign.Center,</span>
<span class="nc" id="L76">            letterSpacing = 0.sp</span>
<span class="nc" id="L77">        )</span>
<span class="nc" id="L78">    }</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">}</span>


@Composable
<span class="nc bnc" id="L83" title="All 6 branches missed.">fun dropLangMenu() {</span>
    // Текущий выбранный язык
<span class="nc" id="L85">    var selectedLanguage by remember { mutableStateOf(availableLanguages[0]) }</span>

    // Состояние для выпадающего меню
<span class="nc" id="L88">    var dropdownExpanded by remember { mutableStateOf(false) }</span>

<span class="nc" id="L90">    Button(</span>
<span class="nc" id="L91">        onClick = { dropdownExpanded = true },</span>
<span class="nc" id="L92">        colors = ButtonDefaults.buttonColors(backgroundColor = Color(0xFF5D4E96)),</span>
<span class="nc" id="L93">        modifier = Modifier.size(width = 180.dp, height = 40.dp)</span>
<span class="nc" id="L94">    ) {</span>
<span class="nc bnc" id="L95" title="All 8 branches missed.">        Text(&quot;Язык: ${selectedLanguage.code.uppercase()}&quot;, color = Color.White)</span>
<span class="nc" id="L96">    }</span>

    // Выпадающее меню с языками
<span class="nc bnc" id="L99" title="All 2 branches missed.">    DropdownMenu(</span>
<span class="nc" id="L100">        expanded = dropdownExpanded,</span>
<span class="nc" id="L101">        onDismissRequest = { dropdownExpanded = false },</span>
<span class="nc" id="L102">        modifier = Modifier.width(180.dp).background(Color.White)</span>
<span class="nc" id="L103">    ) {</span>
<span class="nc bnc" id="L104" title="All 6 branches missed.">        availableLanguages.forEach { language -&gt;</span>
<span class="nc" id="L105">            DropdownMenuItem(</span>
<span class="nc" id="L106">                onClick = {</span>
<span class="nc" id="L107">                    selectedLanguage = language</span>
<span class="nc" id="L108">                    dropdownExpanded = false</span>
                    // Здесь можно добавить код для смены языка в приложении
<span class="nc" id="L110">                    println(&quot;Выбран язык: ${language.name} (${language.code})&quot;)</span>
<span class="nc" id="L111">                }</span>
<span class="nc" id="L112">            ) {</span>
<span class="nc bnc" id="L113" title="All 8 branches missed.">                Text(</span>
<span class="nc" id="L114">                    &quot;${language.code.uppercase()} - ${language.name}&quot;,</span>
<span class="nc bnc" id="L115" title="All 2 branches missed.">                    fontWeight = if (language == selectedLanguage) FontWeight.Bold else FontWeight.Normal</span>
<span class="nc" id="L116">                )</span>
<span class="nc" id="L117">            }</span>
<span class="nc" id="L118">        }</span>
<span class="nc" id="L119">    }</span>
<span class="nc bnc" id="L120" title="All 2 branches missed.">}</span>

@Composable
<span class="nc bnc" id="L123" title="All 10 branches missed.">fun StartScreen(onGameClick: () -&gt; Unit) {</span>
<span class="nc" id="L124">    Box(modifier = Modifier.fillMaxSize().background(Color(0xFFffdfdf))) {</span>

<span class="nc" id="L126">        Box(</span>
<span class="nc" id="L127">            modifier = Modifier</span>
<span class="nc" id="L128">                .background(Color(0xFF3d3d3d))</span>
<span class="nc" id="L129">                .height(80.dp)</span>
<span class="nc" id="L130">                .fillMaxWidth()</span>
        ) {
<span class="nc" id="L132">            Box(modifier = Modifier.align(Alignment.Center)) {</span>
<span class="nc" id="L133">                Text(</span>
<span class="nc" id="L134">                    &quot;ШАХМАТЫ&quot;,</span>
<span class="nc" id="L135">                    textAlign = TextAlign.Center,</span>
<span class="nc" id="L136">                    fontSize = 30.sp,</span>
<span class="nc" id="L137">                    fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L138">                    color = Color.White</span>
                )
<span class="nc" id="L140">            }</span>
<span class="nc" id="L141">            Box(modifier = Modifier.align(Alignment.CenterEnd).padding(vertical = 20.dp)) { dropLangMenu() }</span>
<span class="nc" id="L142">        }</span>

<span class="nc" id="L144">        Box(modifier = Modifier.align(Alignment.CenterStart)) { bokovayaPanel(false) }</span>

<span class="nc" id="L146">        Box(modifier = Modifier.align(Alignment.CenterEnd)) { bokovayaPanel(true) }</span>

<span class="nc" id="L148">        Column(</span>
<span class="nc" id="L149">            modifier = Modifier.align(Alignment.Center),</span>
<span class="nc" id="L150">            horizontalAlignment = Alignment.CenterHorizontally,</span>
<span class="nc" id="L151">            verticalArrangement = Arrangement.Center</span>
        ) {
<span class="nc" id="L153">            standartButton(onGameClick, &quot;Начать игру&quot;, Color.Green)</span>

<span class="nc" id="L155">            Spacer(modifier = Modifier.padding(20.dp))</span>

<span class="nc" id="L157">            standartButton({}, &quot;Загрузить игру&quot;, Color.Blue)</span>
<span class="nc" id="L158">        }</span>

<span class="nc" id="L160">        Box(</span>
<span class="nc" id="L161">            modifier = Modifier</span>
<span class="nc" id="L162">                .fillMaxWidth()</span>
<span class="nc" id="L163">                .height(50.dp)</span>
<span class="nc" id="L164">                .align(Alignment.BottomStart)</span>
<span class="nc" id="L165">                .background(Color(0xFF3d3d3d))</span>
        ) {
<span class="nc" id="L167">            Button(</span>
<span class="nc" id="L168">                onClick = {},</span>
<span class="nc" id="L169">                colors = ButtonDefaults.buttonColors(backgroundColor = Color.Red),</span>
<span class="nc" id="L170">                modifier = Modifier</span>
<span class="nc" id="L171">                    .align(Alignment.CenterStart)</span>
<span class="nc" id="L172">                    .padding(start = 15.dp)</span>
<span class="nc" id="L173">            ) {</span>
<span class="nc bnc" id="L174" title="All 8 branches missed.">                Text(&quot;Выход&quot;, fontSize = 18.sp)</span>
<span class="nc" id="L175">            }</span>

<span class="nc" id="L177">            Text(</span>
<span class="nc" id="L178">                &quot;Версия: Бета 1.0&quot;,</span>
<span class="nc" id="L179">                modifier = Modifier.align(Alignment.Center),</span>
<span class="nc" id="L180">                color = Color(0xFFc7c0c0).copy(alpha = 0.5f),</span>
<span class="nc" id="L181">                fontSize = 20.sp</span>
            )
<span class="nc" id="L183">        }</span>


<span class="nc" id="L186">    }</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">}</span>

@Composable
<span class="nc bnc" id="L190" title="All 10 branches missed.">fun bokovayaPanel(colour: Boolean) {</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">    val figure = if(colour) &quot;white&quot; else &quot;black&quot;</span>
<span class="nc bnc" id="L192" title="All 2 branches missed.">        Image(</span>
<span class="nc" id="L193">            painter = painterResource(&quot;${figure}-pieces-panel.svg&quot;),</span>
<span class="nc" id="L194">            contentDescription = &quot;${figure} figure&quot;,</span>
<span class="nc" id="L195">            modifier = Modifier</span>
<span class="nc" id="L196">                .padding(40.dp)</span>
<span class="nc" id="L197">                .fillMaxHeight(0.7f)</span>
<span class="nc" id="L198">                .fillMaxWidth(0.25f),</span>
<span class="nc" id="L199">            contentScale = ContentScale.FillBounds</span>
        )
<span class="nc bnc" id="L201" title="All 2 branches missed.">}</span>

@Composable
<span class="nc bnc" id="L204" title="All 2 branches missed.">fun GameScreen(onStartClick: () -&gt; Unit, board: Board) {</span>
<span class="nc" id="L205">    Box(modifier = Modifier.fillMaxSize().background(Color(0xFFffdfdf))) {</span>


<span class="nc bnc" id="L208" title="All 2 branches missed.">        if(board.gameWinner != 0) {</span>
<span class="nc" id="L209">            Dialog(</span>
<span class="nc" id="L210">                onDismissRequest = {},</span>
<span class="nc" id="L211">                properties = DialogProperties(</span>
<span class="nc" id="L212">                    dismissOnBackPress = false,</span>
<span class="nc" id="L213">                    dismissOnClickOutside = false</span>
                )
<span class="nc" id="L215">            ) {</span>
<span class="nc bnc" id="L216" title="All 8 branches missed.">                Card() {</span>
<span class="nc bnc" id="L217" title="All 6 branches missed.">                    Column(</span>
<span class="nc" id="L218">                        horizontalAlignment = Alignment.CenterHorizontally</span>
                    ) {
<span class="nc bnc" id="L220" title="All 2 branches missed.">                        if(board.gameWinner == 1) Text(&quot;YOU WON!!!&quot;,</span>
<span class="nc" id="L221">                            fontSize = 23.sp,</span>
<span class="nc" id="L222">                            color = Color.Black,</span>
<span class="nc" id="L223">                            fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L224">                            modifier = Modifier.padding(10.dp)</span>
                            )
<span class="nc bnc" id="L226" title="All 2 branches missed.">                        else if(board.gameWinner == -1) Text(&quot;YOU LOST(((&quot;,</span>
<span class="nc" id="L227">                            fontSize = 23.sp,</span>
<span class="nc" id="L228">                            color = Color.Black,</span>
<span class="nc" id="L229">                            fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L230">                            modifier = Modifier.padding(10.dp)</span>
<span class="nc" id="L231">                        )</span>

<span class="nc" id="L233">                        Button(</span>
<span class="nc" id="L234">                            onClick = { board.reset() },</span>
<span class="nc" id="L235">                            modifier = Modifier.width(200.dp).height(60.dp).padding(10.dp),</span>
<span class="nc" id="L236">                            colors = ButtonDefaults.buttonColors(backgroundColor = Color.Green)</span>
<span class="nc" id="L237">                        ) {</span>
<span class="nc bnc" id="L238" title="All 8 branches missed.">                            Text(&quot;Обновить игру&quot;, fontSize = 23.sp, color = Color.Black, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L239">                        }</span>
<span class="nc" id="L240">                    }</span>
<span class="nc" id="L241">                }</span>
<span class="nc" id="L242">            }</span>
        }


<span class="nc bnc" id="L246" title="All 2 branches missed.">        if(board.isPromoted) {</span>
<span class="nc" id="L247">            Dialog(</span>
<span class="nc" id="L248">                onDismissRequest = {},</span>
<span class="nc" id="L249">                properties = DialogProperties(</span>
<span class="nc" id="L250">                    dismissOnBackPress = false,</span>
<span class="nc" id="L251">                    dismissOnClickOutside = false</span>
                )
<span class="nc" id="L253">            ) {</span>
<span class="nc bnc" id="L254" title="All 8 branches missed.">                Card(</span>

<span class="nc" id="L256">                ) {</span>
<span class="nc bnc" id="L257" title="All 6 branches missed.">                    Row(</span>
<span class="nc" id="L258">                        verticalAlignment = Alignment.CenterVertically</span>
                    ) {
<span class="nc bnc" id="L260" title="All 2 branches missed.">                        val colour = if(!board.turn) &quot;white&quot; else &quot;black&quot;</span>

<span class="nc" id="L262">                        Button(</span>
<span class="nc" id="L263">                            onClick = {board.promotingPawn(&quot;Queen&quot;)},</span>
<span class="nc" id="L264">                            modifier = Modifier</span>
<span class="nc" id="L265">                                .weight(1f)</span>
<span class="nc" id="L266">                                .aspectRatio(1f)</span>
<span class="nc" id="L267">                                .padding(vertical = 20.dp, horizontal = 10.dp)</span>
<span class="nc" id="L268">                                .border(width = 3.dp, color = Color.Black)</span>
<span class="nc" id="L269">                        ) {</span>
<span class="nc bnc" id="L270" title="All 8 branches missed.">                            ChessImage(&quot;${colour}Queen&quot;)</span>
<span class="nc" id="L271">                        }</span>

<span class="nc" id="L273">                        Button(</span>
<span class="nc" id="L274">                            onClick = {board.promotingPawn(&quot;Rook&quot;)},</span>
<span class="nc" id="L275">                            modifier = Modifier</span>
<span class="nc" id="L276">                                .weight(1f)</span>
<span class="nc" id="L277">                                .aspectRatio(1f)</span>
<span class="nc" id="L278">                                .padding(vertical = 20.dp, horizontal = 10.dp)</span>
<span class="nc" id="L279">                                .border(width = 3.dp, color = Color.Black)</span>
<span class="nc" id="L280">                        ) {</span>
<span class="nc bnc" id="L281" title="All 8 branches missed.">                            ChessImage(&quot;${colour}Rook&quot;)</span>
<span class="nc" id="L282">                        }</span>

<span class="nc" id="L284">                        Button(</span>
<span class="nc" id="L285">                            onClick = {board.promotingPawn(&quot;Knight&quot;)},</span>
<span class="nc" id="L286">                            modifier = Modifier</span>
<span class="nc" id="L287">                                .weight(1f)</span>
<span class="nc" id="L288">                                .aspectRatio(1f)</span>
<span class="nc" id="L289">                                .padding(vertical = 20.dp, horizontal = 10.dp)</span>
<span class="nc" id="L290">                                .border(width = 3.dp, color = Color.Black)</span>
<span class="nc" id="L291">                        ) {</span>
<span class="nc bnc" id="L292" title="All 8 branches missed.">                            ChessImage(&quot;${colour}Knight&quot;)</span>
<span class="nc" id="L293">                        }</span>

<span class="nc" id="L295">                        Button(</span>
<span class="nc" id="L296">                            onClick = {board.promotingPawn(&quot;Bishop&quot;)},</span>
<span class="nc" id="L297">                            modifier = Modifier</span>
<span class="nc" id="L298">                                .weight(1f)</span>
<span class="nc" id="L299">                                .aspectRatio(1f)</span>
<span class="nc" id="L300">                                .padding(vertical = 20.dp, horizontal = 10.dp)</span>
<span class="nc" id="L301">                                .border(width = 3.dp, color = Color.Black)</span>
<span class="nc" id="L302">                        ) {</span>
<span class="nc bnc" id="L303" title="All 8 branches missed.">                            ChessImage(&quot;${colour}Bishop&quot;)</span>
<span class="nc" id="L304">                        }</span>
<span class="nc" id="L305">                    }</span>
<span class="nc" id="L306">                }</span>
<span class="nc" id="L307">            }</span>
        }

<span class="nc" id="L310">        Box(</span>
<span class="nc" id="L311">            modifier = Modifier</span>
<span class="nc" id="L312">                .background(Color(0xFF3d3d3d))</span>
<span class="nc" id="L313">                .height(80.dp)</span>
<span class="nc" id="L314">                .fillMaxWidth()</span>
        ) {
<span class="nc" id="L316">            Box(modifier = Modifier.align(Alignment.CenterStart)) {</span>
<span class="nc" id="L317">                Text(</span>
<span class="nc" id="L318">                    &quot;Шахматная Партия&quot;,</span>
<span class="nc" id="L319">                    textAlign = TextAlign.Center,</span>
<span class="nc" id="L320">                    fontSize = 30.sp,</span>
<span class="nc" id="L321">                    fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L322">                    color = Color.White,</span>
<span class="nc" id="L323">                    modifier = Modifier.padding(start = 20.dp)</span>
                )
<span class="nc" id="L325">            }</span>
<span class="nc" id="L326">            Box(modifier = Modifier.align(Alignment.CenterEnd).padding(vertical = 20.dp)) { dropLangMenu() }</span>

<span class="nc" id="L328">        }</span>

<span class="nc" id="L330">        Column(</span>
<span class="nc" id="L331">            modifier = Modifier</span>
<span class="nc" id="L332">                .align(Alignment.CenterStart)</span>
<span class="nc" id="L333">                .fillMaxSize(0.45f)</span>
<span class="nc" id="L334">                .aspectRatio(1f)</span>
<span class="nc" id="L335">                .padding(start = 120.dp, top = 50.dp)</span>
<span class="nc" id="L336">                .border(width = 1.dp, color = Color.Blue)</span>
        ) {
<span class="nc" id="L338">            var selectedPosition by remember { mutableStateOf&lt;Int?&gt;(null) }</span>

<span class="nc bnc" id="L340" title="All 2 branches missed.">            for(rows in 1..8) {</span>

<span class="nc" id="L342">                Row(</span>
<span class="nc" id="L343">                    modifier = Modifier</span>
<span class="nc" id="L344">                        .weight(0.125f)</span>
<span class="nc" id="L345">                        .fillMaxWidth()</span>
                ) {
<span class="nc bnc" id="L347" title="All 2 branches missed.">                    for(sq in 0..7) {</span>
<span class="nc" id="L348">                        val square = 64 - rows * 8 + sq</span>
<span class="nc bnc" id="L349" title="All 2 branches missed.">                        val colour = if( ( (square / 8) + (square % 8) ) % 2 == 1) Color.Red else Color.Blue</span>
<span class="nc" id="L350">                        Box(contentAlignment = Alignment.Center,</span>
<span class="nc" id="L351">                            modifier = Modifier</span>
<span class="nc bnc" id="L352" title="All 4 branches missed.">                                .background(if(selectedPosition == square) Color.Green</span>
<span class="nc bnc" id="L353" title="All 8 branches missed.">                                else if(board.isThereFigure(square) &amp;&amp; (board.positions[square]?.colour == board.turn)</span>
<span class="nc bnc" id="L354" title="All 4 branches missed.">                                    &amp;&amp; board.positions[square] is King &amp;&amp; board.composeChecked) Color(0xFFf5fba7)</span>
<span class="nc bnc" id="L355" title="All 8 branches missed.">                                else if(board.isThereFigure(square) &amp;&amp; (board.positions[square]?.colour == board.turn)</span>
<span class="nc bnc" id="L356" title="All 4 branches missed.">                                    &amp;&amp; board.positions[square] is King &amp;&amp; board.gameWinner != 0) Color.White</span>
<span class="nc" id="L357">                                else colour)</span>
<span class="nc" id="L358">                                .weight(0.125f)</span>
<span class="nc" id="L359">                                .fillMaxSize()</span>
<span class="nc" id="L360">                                .clickable(onClick = {</span>
<span class="nc bnc" id="L361" title="All 4 branches missed.">                                    if(selectedPosition == null &amp;&amp; board.isThereFigure(square)) {</span>
<span class="nc" id="L362">                                        selectedPosition = square</span>
                                    }
<span class="nc bnc" id="L364" title="All 2 branches missed.">                                    else if(selectedPosition != null) {</span>
<span class="nc bnc" id="L365" title="All 2 branches missed.">                                        selectedPosition?.let{</span>
<span class="nc" id="L366">                                            board.move(it, square)</span>
                                        }
<span class="nc" id="L368">                                        selectedPosition = null</span>
                                    }
<span class="nc" id="L370">                                })</span>
                        ) {
<span class="nc bnc" id="L372" title="All 2 branches missed.">                            if(square in board.composePositions.value.keys) {</span>
<span class="nc bnc" id="L373" title="All 2 branches missed.">                                board.composePositions.value[square]?.let {</span>
<span class="nc" id="L374">                                    ChessImage(it.figure)</span>
<span class="nc" id="L375">                                }</span>

                            }
<span class="nc" id="L378">                            Text(board.fromDigToNot(square))</span>
<span class="nc" id="L379">                        }</span>
                    }
<span class="nc" id="L381">                }</span>
            }

<span class="nc" id="L384">        }</span>


<span class="nc" id="L387">        Box(</span>
<span class="nc" id="L388">            modifier = Modifier</span>
<span class="nc" id="L389">                .fillMaxWidth(0.5f)</span>
<span class="nc" id="L390">                .align(Alignment.CenterEnd)</span>
        ) {
<span class="nc" id="L392">            Column(</span>
<span class="nc" id="L393">                modifier = Modifier</span>
<span class="nc" id="L394">                    .fillMaxWidth(0.45f)</span>
<span class="nc" id="L395">                    .align(Alignment.CenterStart)</span>
            ) {
<span class="nc" id="L397">                Column(</span>
<span class="nc" id="L398">                    modifier = Modifier</span>
<span class="nc" id="L399">                        .border(width = 3.dp, color = Color.Black, shape = RoundedCornerShape(8.dp))</span>
<span class="nc" id="L400">                        .fillMaxWidth().padding(10.dp),</span>
<span class="nc" id="L401">                    horizontalAlignment = Alignment.CenterHorizontally</span>
                ) {
<span class="nc" id="L403">                    Text(&quot;Player 1&quot;, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L404">                    Spacer(modifier = Modifier.padding(10.dp))</span>
<span class="nc" id="L405">                    Text(&quot;Rating: 1500&quot;)</span>
<span class="nc" id="L406">                    Spacer(modifier = Modifier.padding(10.dp))</span>
<span class="nc" id="L407">                    Column(</span>
<span class="nc" id="L408">                        modifier = Modifier</span>
<span class="nc" id="L409">                            .size(width = 120.dp, height = 40.dp)</span>
<span class="nc" id="L410">                            .background(Color.Yellow)</span>
                    ) {

<span class="nc" id="L413">                    }</span>
<span class="nc" id="L414">                }</span>



<span class="nc" id="L418">                Spacer(modifier = Modifier.padding(10.dp))</span>


<span class="nc" id="L421">                Column(</span>
<span class="nc" id="L422">                    modifier = Modifier</span>
<span class="nc" id="L423">                        .border(width = 3.dp, color = Color.Black, shape = RoundedCornerShape(8.dp))</span>
<span class="nc" id="L424">                        .fillMaxWidth().padding(10.dp),</span>
<span class="nc" id="L425">                    horizontalAlignment = Alignment.CenterHorizontally</span>
                ) {
<span class="nc" id="L427">                    Text(&quot;Player 2&quot;, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L428">                    Spacer(modifier = Modifier.padding(10.dp))</span>
<span class="nc" id="L429">                    Text(&quot;Rating: 1500&quot;)</span>
<span class="nc" id="L430">                    Spacer(modifier = Modifier.padding(10.dp))</span>
<span class="nc" id="L431">                    Column(</span>
<span class="nc" id="L432">                        modifier = Modifier</span>
<span class="nc" id="L433">                            .size(width = 120.dp, height = 40.dp)</span>
<span class="nc" id="L434">                            .background(Color.Yellow)</span>
                    ) {

<span class="nc" id="L437">                    }</span>
<span class="nc" id="L438">                }</span>

<span class="nc" id="L440">                Spacer(modifier = Modifier.padding(5.dp))</span>

<span class="nc" id="L442">                Button(</span>
<span class="nc" id="L443">                    onClick = { board.reset() },</span>
<span class="nc" id="L444">                    modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L445">                    colors = ButtonDefaults.buttonColors(backgroundColor = Color.Green)</span>
<span class="nc" id="L446">                ) {</span>
<span class="nc bnc" id="L447" title="All 8 branches missed.">                    Text(&quot;Обновить игру&quot;, fontSize = 23.sp, color = Color.Black, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L448">                }</span>

<span class="nc" id="L450">                Spacer(modifier = Modifier.padding(5.dp))</span>

<span class="nc" id="L452">                Button(</span>
<span class="nc" id="L453">                    onClick = {  },</span>
<span class="nc" id="L454">                    modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L455">                    colors = ButtonDefaults.buttonColors(backgroundColor = Color.Yellow)</span>
<span class="nc" id="L456">                ) {</span>
<span class="nc bnc" id="L457" title="All 8 branches missed.">                    Text(&quot;Сдаться&quot;, fontSize = 23.sp, color = Color.Black, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L458">                }</span>

<span class="nc" id="L460">                Spacer(modifier = Modifier.padding(5.dp))</span>

<span class="nc" id="L462">                Button(</span>
<span class="nc" id="L463">                    onClick = {  },</span>
<span class="nc" id="L464">                    modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L465">                    colors = ButtonDefaults.buttonColors(backgroundColor = Color.Blue)</span>
<span class="nc" id="L466">                ) {</span>
<span class="nc bnc" id="L467" title="All 8 branches missed.">                    Text(&quot;Предложить ничью&quot;, fontSize = 23.sp, color = Color.Black, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L468">                }</span>

<span class="nc" id="L470">                Spacer(modifier = Modifier.padding(5.dp))</span>

<span class="nc" id="L472">                Button(</span>
<span class="nc" id="L473">                    onClick = {  },</span>
<span class="nc" id="L474">                    modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L475">                    colors = ButtonDefaults.buttonColors(backgroundColor = Color.Blue)</span>
<span class="nc" id="L476">                ) {</span>
<span class="nc bnc" id="L477" title="All 8 branches missed.">                    Text(&quot;Сохранить игру&quot;, fontSize = 23.sp, color = Color.Black, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L478">                }</span>

<span class="nc" id="L480">                Spacer(modifier = Modifier.padding(5.dp))</span>

<span class="nc" id="L482">                Text(&quot;Turn: ${board.turn}&quot;, fontSize = 20.sp, modifier = Modifier</span>
<span class="nc" id="L483">                    .border(width = 3.dp, color = Color.Black)</span>
<span class="nc" id="L484">                    .fillMaxWidth()</span>
<span class="nc" id="L485">                    .height(40.dp)</span>
<span class="nc" id="L486">                    .background(Color.Cyan)</span>
<span class="nc" id="L487">                    .wrapContentHeight(align = Alignment.CenterVertically)</span>
<span class="nc" id="L488">                    .wrapContentWidth(align = Alignment.CenterHorizontally),</span>
<span class="nc" id="L489">                    fontWeight = FontWeight.Bold</span>
                )

<span class="nc" id="L492">                Spacer(modifier = Modifier.padding(20.dp))</span>

<span class="nc" id="L494">                Button (</span>
<span class="nc" id="L495">                    onClick = onStartClick,</span>
<span class="nc" id="L496">                    modifier = Modifier.fillMaxWidth().height(60.dp),</span>
<span class="nc" id="L497">                    colors = ButtonDefaults.buttonColors(backgroundColor = Color.Transparent)</span>
<span class="nc" id="L498">                ) {</span>
<span class="nc bnc" id="L499" title="All 8 branches missed.">                    Text(&quot;Назад&quot;, fontSize = 23.sp, color = Color.Black, fontWeight = FontWeight.Bold)</span>
<span class="nc" id="L500">                }</span>
<span class="nc" id="L501">            }</span>

<span class="nc" id="L503">            Column(</span>
<span class="nc" id="L504">                modifier = Modifier</span>
<span class="nc" id="L505">                    .align(Alignment.CenterEnd)</span>
<span class="nc" id="L506">                    .fillMaxWidth(0.45f)</span>
            ) {
<span class="nc" id="L508">                Card(</span>
<span class="nc" id="L509">                    elevation = 4.dp,</span>
<span class="nc" id="L510">                    modifier = Modifier</span>
<span class="nc" id="L511">                        .fillMaxWidth()</span>
<span class="nc" id="L512">                        .padding(10.dp)</span>
<span class="nc" id="L513">                ) {</span>
<span class="nc bnc" id="L514" title="All 6 branches missed.">                    Column {</span>
<span class="nc" id="L515">                        Row(modifier = Modifier.height(40.dp).background(Color(0xFFd5d5d5)),</span>
<span class="nc" id="L516">                            verticalAlignment = Alignment.CenterVertically) {</span>
<span class="nc" id="L517">                            Text(&quot;Запись ходов&quot;,</span>
<span class="nc" id="L518">                                fontSize = 23.sp,</span>
<span class="nc" id="L519">                                fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L520">                                modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L521">                                textAlign = TextAlign.Center</span>
                            )
<span class="nc" id="L523">                        }</span>

<span class="nc" id="L525">                        val listState = rememberLazyListState()</span>
<span class="nc" id="L526">                        LaunchedEffect(board.whiteMoves.size) {</span>
<span class="nc bnc" id="L527" title="All 2 branches missed.">                            if(board.whiteMoves.size &gt; 0) {</span>
<span class="nc" id="L528">                                listState.animateScrollToItem(board.whiteMoves.size - 1)</span>
                            }
<span class="nc" id="L530">                        }</span>

<span class="nc" id="L532">                        LazyColumn(</span>
<span class="nc" id="L533">                            modifier = Modifier</span>
<span class="nc" id="L534">                                .heightIn(max = 600.dp)</span>
<span class="nc" id="L535">                                .fillMaxWidth(),</span>
<span class="nc" id="L536">                            state = listState</span>
                        ) {
<span class="nc" id="L538">                            items(count = board.whiteMoves.size) { item -&gt;</span>
<span class="nc bnc" id="L539" title="All 6 branches missed.">                                Row(</span>
<span class="nc" id="L540">                                    modifier = Modifier</span>
<span class="nc" id="L541">                                        .fillMaxWidth()</span>
<span class="nc" id="L542">                                        .height(45.dp)</span>
<span class="nc" id="L543">                                        .border(0.15.dp, color = Color.Black)</span>
<span class="nc" id="L544">                                        .background(Color(0xFFfff6f6))</span>
                                ) {
<span class="nc" id="L546">                                    Text(</span>
<span class="nc" id="L547">                                        &quot;${item + 1}.&quot;,</span>
<span class="nc" id="L548">                                        modifier = Modifier</span>
<span class="nc" id="L549">                                            .fillMaxHeight()</span>
<span class="nc" id="L550">                                            .weight(0.2f)</span>
<span class="nc" id="L551">                                            .border(0.15.dp, color = Color.Black)</span>
<span class="nc" id="L552">                                            .wrapContentHeight(align = Alignment.CenterVertically)</span>
<span class="nc" id="L553">                                            .wrapContentWidth(align = Alignment.CenterHorizontally),</span>
<span class="nc" id="L554">                                        fontSize = 17.sp,</span>
<span class="nc" id="L555">                                        fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L556">                                        textAlign = TextAlign.Center</span>
                                    )

<span class="nc" id="L559">                                    Text(</span>
<span class="nc" id="L560">                                        board.whiteMoves[item],</span>
<span class="nc" id="L561">                                        modifier = Modifier</span>
<span class="nc" id="L562">                                            .fillMaxHeight()</span>
<span class="nc" id="L563">                                            .weight(0.4f)</span>
<span class="nc" id="L564">                                            .wrapContentHeight(align = Alignment.CenterVertically)</span>
<span class="nc" id="L565">                                            .wrapContentWidth(align = Alignment.CenterHorizontally),</span>
<span class="nc" id="L566">                                        fontSize = 17.sp,</span>
<span class="nc" id="L567">                                        fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L568">                                        textAlign = TextAlign.Center</span>
                                    )

<span class="nc" id="L571">                                    Text(</span>
<span class="nc bnc" id="L572" title="All 2 branches missed.">                                        if(board.blackMoves.size &gt; item) board.blackMoves[item] else &quot;&quot;,</span>
<span class="nc" id="L573">                                        modifier = Modifier</span>
<span class="nc" id="L574">                                            .fillMaxHeight()</span>
<span class="nc" id="L575">                                            .weight(0.4f)</span>
<span class="nc" id="L576">                                            .wrapContentHeight(align = Alignment.CenterVertically)</span>
<span class="nc" id="L577">                                            .wrapContentWidth(align = Alignment.CenterHorizontally),</span>
<span class="nc" id="L578">                                        fontSize = 17.sp,</span>
<span class="nc" id="L579">                                        fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L580">                                        textAlign = TextAlign.Center</span>
                                    )
<span class="nc" id="L582">                                }</span>
<span class="nc" id="L583">                            }</span>
<span class="nc" id="L584">                        }</span>
<span class="nc" id="L585">                    }</span>


<span class="nc" id="L588">                }</span>
<span class="nc" id="L589">            }</span>
<span class="nc" id="L590">        }</span>
<span class="nc" id="L591">            }</span>
<span class="nc" id="L592">}</span>


@Composable
<span class="nc bnc" id="L596" title="All 10 branches missed.">fun ChessImage(figure: String) {</span>
<span class="nc bnc" id="L597" title="All 13 branches missed.">    when(figure) {</span>
<span class="nc" id="L598">        &quot;whitePawn&quot; -&gt; Image(painter = painterResource(&quot;white-pawn.svg&quot;), contentDescription = &quot;White Pawn&quot;)</span>
<span class="nc" id="L599">        &quot;blackPawn&quot; -&gt; Image(painter = painterResource(&quot;black-pawn.svg&quot;), contentDescription = &quot;Black Pawn&quot;)</span>
<span class="nc" id="L600">        &quot;whiteRook&quot; -&gt; Image(painter = painterResource(&quot;white-rook.svg&quot;), contentDescription = &quot;White Rook&quot;)</span>
<span class="nc" id="L601">        &quot;blackRook&quot; -&gt; Image(painter = painterResource(&quot;black-rook.svg&quot;), contentDescription = &quot;Black Rook&quot;)</span>
<span class="nc" id="L602">        &quot;whiteKnight&quot; -&gt; Image(painter = painterResource(&quot;white-knight.svg&quot;), contentDescription = &quot;White Knight&quot;)</span>
<span class="nc" id="L603">        &quot;blackKnight&quot; -&gt; Image(painter = painterResource(&quot;black-knight.svg&quot;), contentDescription = &quot;Black Knight&quot;)</span>
<span class="nc" id="L604">        &quot;whiteBishop&quot; -&gt; Image(painter = painterResource(&quot;white-bishop.svg&quot;), contentDescription = &quot;White Bishop&quot;)</span>
<span class="nc" id="L605">        &quot;blackBishop&quot; -&gt; Image(painter = painterResource(&quot;black-bishop.svg&quot;), contentDescription = &quot;Black Bishop&quot;)</span>
<span class="nc" id="L606">        &quot;whiteKing&quot; -&gt; Image(painter = painterResource(&quot;white-king.svg&quot;), contentDescription = &quot;White King&quot;)</span>
<span class="nc" id="L607">        &quot;blackKing&quot; -&gt; Image(painter = painterResource(&quot;black-king.svg&quot;), contentDescription = &quot;Black King&quot;)</span>
<span class="nc" id="L608">        &quot;whiteQueen&quot; -&gt; Image(painter = painterResource(&quot;white-queen.svg&quot;), contentDescription = &quot;White Queen&quot;)</span>
<span class="nc" id="L609">        &quot;blackQueen&quot; -&gt; Image(painter = painterResource(&quot;black-queen.svg&quot;), contentDescription = &quot;Black Queen&quot;)</span>
<span class="nc bnc" id="L610" title="All 2 branches missed.">        else -&gt; Image(painter = painterResource(&quot;white-pawn.svg&quot;), contentDescription = &quot;White Pawn&quot;)</span>
    }
<span class="nc bnc" id="L612" title="All 2 branches missed.">}</span>

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>